<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Wise Soweto Outreach - Final Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0066cc;
            --secondary-blue: #0099ff;
            --light-blue: #e6f2ff;
            --dark-blue: #004d99;
            --accent-teal: #00cccc;
            --white: #ffffff;
            --light-gray: #f5f7fa;
            --text-dark: #333333;
            --success-green: #28a745;
            --warning-orange: #ffc107;
            --danger-red: #dc3545;
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: var(--text-dark);
            line-height: 1.6;
            position: relative;
        }

        /* Water Droplets Background Animation */
        .water-drop {
            position: fixed;
            top: -10%;
            width: 15px;
            height: 15px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50% 50% 50% 0;
            transform: rotate(45deg);
            animation: fall linear infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes fall {
            to {
                top: 110%;
                opacity: 0;
            }
        }

        .dashboard {
            position: relative;
            z-index: 2;
        }

        /* Header Section */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo {
            font-size: 3rem;
            color: white;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            animation: slideInDown 0.8s ease-out;
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h2 {
            font-size: 1.5rem;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 15px;
            animation: slideInDown 0.8s ease-out 0.2s both;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            animation: slideInDown 0.8s ease-out 0.4s both;
        }

        .date-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideInDown 0.8s ease-out 0.6s both;
        }

        .pulse-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.3);
            }
        }

        /* Quick Stats Dashboard */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stat-card.primary .stat-icon { color: var(--primary-blue); }
        .stat-card.success .stat-icon { color: var(--success-green); }
        .stat-card.warning .stat-icon { color: var(--warning-orange); }
        .stat-card.info .stat-icon { color: var(--accent-teal); }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
            font-variant-numeric: tabular-nums;
        }

        .stat-label {
            font-size: 0.95rem;
            color: #718096;
            font-weight: 500;
        }

        .progress-bar-shimmer {
            position: relative;
            overflow: hidden;
        }

        .progress-bar-shimmer::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            to {
                left: 100%;
            }
        }

        /* Bootstrap Nav Pills Enhancement */
        .nav-pills .nav-link {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 0 5px;
        }

        .nav-pills .nav-link:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .nav-pills .nav-link.active {
            background: rgba(255, 255, 255, 0.3) !important;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Tooltip Enhancement */
        .tooltip-inner {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 8px 12px;
        }

        /* Cards Enhancement */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 102, 204, 0.1), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
        }

        .card-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-blue), var(--accent-teal));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .card:hover .card-title::after {
            width: 80%;
        }

        /* Badge Enhancement */
        .badge {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        /* Alert Boxes */
        .alert {
            border-radius: 15px;
            border: none;
            backdrop-filter: blur(10px);
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .toast-success {
            border-left: 5px solid var(--success-green);
        }

        /* Modal Enhancement */
        .modal-content {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .modal-header {
            border-bottom: 1px solid rgba(0, 102, 204, 0.2);
        }

        .modal-footer {
            border-top: 1px solid rgba(0, 102, 204, 0.2);
        }

        /* Button Enhancements */
        .btn-custom {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .btn-custom:focus {
            outline: 3px solid rgba(255, 255, 255, 0.5);
            outline-offset: 2px;
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 250px;
            transition: transform 0.3s ease;
        }

        .card:hover .chart-container {
            transform: scale(1.05);
        }

        /* Keyboard Navigation */
        *:focus-visible {
            outline: 3px solid rgba(0, 204, 204, 0.8);
            outline-offset: 2px;
        }

        /* Quote and Insights Cards */
        .quote-card {
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--white) 100%);
            border-left: 5px solid var(--accent-teal);
        }

        .insights-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid var(--warning-orange);
        }

        .solutions-card {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 5px solid var(--success-green);
        }

        .insights-list, .solutions-list {
            list-style-type: none;
            padding-left: 0;
        }

        .insights-list li, .solutions-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #e2e8f0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .insights-list li:last-child, .solutions-list li:last-child {
            border-bottom: none;
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            color: white;
            margin: 40px 0 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
            }
            .btn-custom, .nav-pills, .toast-container, .water-drop {
                display: none !important;
            }
            .card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }

        /* Skeleton Loader */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .stat-value { font-size: 2rem; }
            .quick-stats {
                grid-template-columns: 1fr;
            }
        }

        /* NEW: PDF Button Styles */
        .pdf-btn {
            background: linear-gradient(135deg, var(--danger-red), #c82333);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .pdf-btn:hover {
            background: linear-gradient(135deg, #c82333, var(--danger-red));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        /* PDF Preview Modal */
        .pdf-preview {
            height: 80vh;
            width: 100%;
            border: none;
            border-radius: 10px;
        }

        .pdf-placeholder {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
        }

        .pdf-icon {
            font-size: 4rem;
            color: var(--danger-red);
            margin-bottom: 20px;
        }

        .pdf-download-link {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: var(--primary-blue);
            color: white;
            border-radius: 5px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .pdf-download-link:hover {
            background: var(--dark-blue);
            color: white;
            text-decoration: none;
            transform: translateY(-2px);
        }

        @media (max-width: 576px) {
            .nav-pills {
                flex-direction: column !important;
                align-items: center;
            }
            .nav-pills .nav-item {
                width: 100%;
                margin-bottom: 10px;
            }
            .nav-pills .nav-link {
                width: 100%;
                padding: 12px 20px;
                font-size: 1rem !important;
                color: rgb(27, 39, 212) !important;
                background: rgba(255, 255, 255, 0.2) !important;
                border: 1px solid rgba(255, 255, 255, 0.3) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                gap: 8px !important;
                opacity: 1 !important;
                visibility: visible !important;
            }
            .nav-pills .nav-link i {
                font-size: 1.2rem !important;
                color: rgb(21, 63, 215) !important;
            }
            .nav-pills .nav-link.active {
                background: rgba(255, 255, 255, 0.4) !important;
            }
            .d-flex.justify-content-center.gap-3.flex-wrap.mt-3 {
                flex-direction: column;
                gap: 10px !important;
            }
            .btn-custom, .pdf-btn {
                width: 100%;
                padding: 12px !important;
                font-size: 1rem !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                gap: 8px !important;
            }
            .pdf-btn {
                background: linear-gradient(135deg, var(--danger-red), #c82333) !important;
                color: white !important;
            }
            .btn-custom i, .pdf-btn i {
                font-size: 1.2rem !important;
            }
            .header {
                padding: 20px 15px;
            }
            .header h1 {
                font-size: 1.8rem;
            }
            .header h2 {
                font-size: 1.3rem;
            }
            .header p {
                font-size: 1rem;
            }
            .logo-container {
                flex-direction: row;
                justify-content: center;
            }
            .logo {
                font-size: 2rem;
            }
            .date-badge {
                font-size: 0.85rem;
                padding: 8px 16px;
            }
            /* Ensure no skeleton or hidden elements */
            .skeleton {
                display: none !important;
            }
        }
        @media (max-width: 768px) {
            .nav-pills {
                flex-direction: column !important;
            }
            .nav-pills .nav-link {
                justify-content: center !important;
                gap: 10px !important;
            }
            .quick-stats {
                grid-template-columns: 1fr !important;
            }
        }

        /* Mobile Action Button Font Colors */
        .action-btn {
            color: white !important;
            font-weight: 600;
        }

        .action-btn i {
            color: rgb(46, 18, 228) !important;
        }

        /* Specific button colors if you want different text colors */
        .action-btn:nth-child(1) {
            color: rgb(21, 52, 233) !important;
            background: rgba(255, 255, 255, 0.2) !important;
        }

        .action-btn:nth-child(2) {
            color: rgb(35, 38, 230) !important;
            background: rgba(255, 255, 255, 0.2) !important;
        }

        .action-btn:nth-child(3) {
            color: rgb(255, 255, 255) !important;
            background: rgba(255, 255, 255, 0.2) !important;
        }

        .pdf-btn-mobile {
            color: white !important;
            background: linear-gradient(135deg, #dc3545, #c82333) !important;
        }

        /* Hover states */
        .action-btn:hover {
            color: white !important;
            background: rgba(255, 255, 255, 0.3) !important;
        }

        .pdf-btn-mobile:hover {
            color: white !important;
            background: linear-gradient(135deg, #c82333, #dc3545) !important;
        }

        /* Alternative - Dark Blue Font Color for All Mobile Elements */
        @media (max-width: 768px) {
            /* Action Buttons */
            .btn-custom {
                background: rgba(255, 255, 255, 0.98) !important;
                border: 2px solid #004d99 !important;
                color: #004d99 !important;
            }
            
            .btn-custom i {
                color: #004d99 !important;
            }
            
            /* Navigation Pills/Tabs */
            .nav-pills .nav-link {
                background: rgba(255, 255, 255, 0.98) !important;
                border: 2px solid #004d99 !important;
                color: #004d99 !important;
            }
            
            .nav-pills .nav-link i {
                color: #004d99 !important;
            }
            
            .nav-pills .nav-link.active {
                background: #004d99 !important;
                border: 2px solid #004d99 !important;
                color: white !important;
            }
            
            .nav-pills .nav-link.active i {
                color: white !important;
            }
            
            /* Data Sources Badge */
            .date-badge {
                background: rgba(255, 255, 255, 0.98) !important;
                border: 2px solid #004d99 !important;
                color: #004d99 !important;
            }
            
            .date-badge .pulse-dot {
                background: #004d99 !important;
            }
            
            /* PDF Button */
            .pdf-btn {
                background: rgba(255, 255, 255, 0.98) !important;
                border: 2px solid #dc3545 !important;
                color: #dc3545 !important;
            }
            
            .pdf-btn i {
                color: #dc3545 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Water Droplets Background -->
    <div id="waterDrops"></div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="dashboard container-fluid py-4">
        <div class="header">
            <div class="logo-container">
                <i class="fas fa-tint logo"></i>
                <h1>Water Wise Soweto Outreach</h1>
            </div>
            <h2>Final Report (Day 1 to Summit Completion)</h2>
            <p>The final Soweto outreach phase, spanning all groundwork days and culminating in the Water Wise Summit, achieved high participation and deep qualitative engagement. The data collection effort was robust, with strong community feedback and measurable insights on water usage, awareness, and conservation challenges.</p>
            <div class="date-badge">
                <span class="pulse-dot"></span>Data Sources: Household Surveys, Summit Feedback, Focus Groups
            </div>
            
            <!-- Bootstrap Nav Pills -->
            <ul class="nav nav-pills justify-content-center mt-4 mb-3 flex-wrap" id="reportTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="overview-tab" data-bs-toggle="pill" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true" data-bs-toggle="tooltip" title="View project overview and key achievements">
                        <i class="fas fa-chart-pie"></i> Overview
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="quantitative-tab" data-bs-toggle="pill" data-bs-target="#quantitative" type="button" role="tab" aria-controls="quantitative" aria-selected="false" data-bs-toggle="tooltip" title="Explore data-driven insights and trends">
                        <i class="fas fa-chart-bar"></i> Quantitative
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="qualitative-tab" data-bs-toggle="pill" data-bs-target="#qualitative" type="button" role="tab" aria-controls="qualitative" aria-selected="false" data-bs-toggle="tooltip" title="Read community voices and feedback">
                        <i class="fas fa-comments"></i> Qualitative
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="recommendations-tab" data-bs-toggle="pill" data-bs-target="#recommendations" type="button" role="tab" aria-controls="recommendations" aria-selected="false" data-bs-toggle="tooltip" title="View actionable recommendations">
                        <i class="fas fa-lightbulb"></i> Recommendations
                    </button>
                </li>
            </ul>
            
            <div class="d-flex justify-content-center gap-3 flex-wrap mt-3">
                <button class="btn btn-custom" id="printBtn" data-bs-toggle="tooltip" title="Print this report (Alt+P)">
                    <i class="fas fa-print"></i> Print Report
                </button>
                <button class="btn btn-custom" id="downloadBtn" data-bs-toggle="tooltip" title="Download data as Excel (Alt+D)">
                    <i class="fas fa-download"></i> Download Data
                </button>
                <button class="btn btn-custom" id="shareBtn" data-bs-toggle="modal" data-bs-target="#shareModal" data-bs-toggle="tooltip" title="Share this report">
                    <i class="fas fa-share-alt"></i> Share Report
                </button>
                <!-- NEW: PDF Report Button -->
                <button class="btn pdf-btn" id="pdfBtn" data-bs-toggle="modal" data-bs-target="#pdfModal" data-bs-toggle="tooltip" title="View or Download Full PDF Report">
                    <i class="fas fa-file-pdf"></i> Full PDF Report
                </button>
            </div>
        </div>

        <!-- Quick Stats Dashboard -->
        <div class="quick-stats">
            <div class="stat-card primary">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-value" data-target="292">0</div>
                <div class="stat-label">Total Participants</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-primary" style="width: 100%"></div>
                </div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon"><i class="fas fa-graduation-cap"></i></div>
                <div class="stat-value" data-target="78">0</div>
                <div class="stat-label">Workshop Interest (%)</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-success" style="width: 78%"></div>
                </div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon"><i class="fas fa-clipboard-list"></i></div>
                <div class="stat-value" data-target="67">0</div>
                <div class="stat-label">Surveys Completed</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-warning" style="width: 67%"></div>
                </div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon"><i class="fas fa-water"></i></div>
                <div class="stat-value" data-target="80">0</div>
                <div class="stat-label">Water Concern (%)</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-info" style="width: 80%"></div>
                </div>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content" id="reportTabContent">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
                <div class="section-header">
                    <h2><i class="fas fa-chart-pie"></i> Project Overview</h2>
                    <p>Summary of the Soweto Water Wise Outreach Initiative</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Project Timeline & Key Milestones</div>
                                <div class="chart-container">
                                    <canvas id="timelineChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Data Collection Summary</div>
                                <div class="chart-container">
                                    <canvas id="dataCollectionChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Community Engagement Metrics</div>
                                <div class="chart-container">
                                    <canvas id="engagementChart"></canvas>
                                </div>
                                <div class="row text-center mt-3 pt-3 border-top">
                                    <div class="col-4">
                                        <div class="stat-value text-primary">78%</div>
                                        <div class="stat-label">Workshop Interest</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">80%</div>
                                        <div class="stat-label">Water Concern</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">90%</div>
                                        <div class="stat-label">Community Role Belief</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card insights-card">
                            <div class="card-body">
                                <div class="card-title">Key Project Achievements</div>
                                <ul class="insights-list">
                                    <li><i class="fas fa-check-circle"></i> <strong>High Participation:</strong> Robust data collection across all outreach days with strong community engagement</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Deep Qualitative Insights:</strong> Captured authentic community voices and practical challenges</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Measurable Impact:</strong> Clear data-driven insights on water usage, awareness, and conservation challenges</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Trust Building:</strong> Established stronger connections between community and water authorities</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Actionable Intelligence:</strong> Data-to-action pipeline for evidence-based interventions</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quantitative Tab -->
            <div class="tab-pane fade" id="quantitative" role="tabpanel" aria-labelledby="quantitative-tab">
                <div class="section-header">
                    <h2><i class="fas fa-chart-bar"></i> Quantitative Analysis</h2>
                    <p>Data-driven insights and trends from household surveys</p>
                </div>

                <div class="row g-4">
                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Household Size Distribution</div>
                                <div class="chart-container">
                                    <canvas id="householdChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Dwelling Types</div>
                                <div class="chart-container">
                                    <canvas id="dwellingChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Property Ownership</div>
                                <div class="chart-container">
                                    <canvas id="ownershipChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Meter Access</div>
                                <div class="chart-container">
                                    <canvas id="meterChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Shortage Frequency</div>
                                <div class="chart-container">
                                    <canvas id="shortageChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Infrastructure Rating</div>
                                <div class="chart-container">
                                    <canvas id="infrastructureChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water-Saving Devices Usage</div>
                                <div class="chart-container">
                                    <canvas id="devicesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Garden Watering Methods</div>
                                <div class="chart-container">
                                    <canvas id="gardenChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Conservation Education</div>
                                <div class="chart-container">
                                    <canvas id="educationChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Community Willingness & Engagement</div>
                                <div class="chart-container">
                                    <canvas id="willingnessChart"></canvas>
                                </div>
                                <div class="row text-center mt-3 pt-3 border-top">
                                    <div class="col-4">
                                        <div class="stat-value text-primary">78%</div>
                                        <div class="stat-label">Workshop Interest</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">75%</div>
                                        <div class="stat-label">Adoption Willingness</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">60%</div>
                                        <div class="stat-label">Reporting Knowledge Gap</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Qualitative Tab -->
            <div class="tab-pane fade" id="qualitative" role="tabpanel" aria-labelledby="qualitative-tab">
                <div class="section-header">
                    <h2><i class="fas fa-comments"></i> Qualitative Insights</h2>
                    <p>Community voices, challenges, and summit feedback</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card quote-card">
                            <div class="card-body">
                                <div class="card-title">Resident Voices - Key Challenges</div>
                                <div class="quote-text">
                                    "We don't know when water will go. No one tells us."
                                </div>
                                <div class="quote-author">- Soweto Resident</div>
                                <div class="quote-text" style="margin-top: 15px;">
                                    "Our meter doesn't work, and no one comes to fix it."
                                </div>
                                <div class="quote-author">- Soweto Resident</div>
                                <div class="quote-text" style="margin-top: 15px;">
                                    "We wash food with grey water when there's no water."
                                </div>
                                <div class="quote-author">- Soweto Resident</div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Communication Gaps</div>
                                <div class="chart-container">
                                    <canvas id="communicationChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card insights-card">
                            <div class="card-body">
                                <div class="card-title">Key Challenges Identified</div>
                                <ul class="insights-list">
                                    <li><i class="fas fa-exclamation-triangle"></i> <strong>Lack of communication</strong> on planned outages</li>
                                    <li><i class="fas fa-tachometer-alt"></i> <strong>Broken or non-functional water meters</strong></li>
                                    <li><i class="fas fa-recycle"></i> <strong>Reliance on greywater</strong> for cleaning and food washing</li>
                                    <li><i class="fas fa-question-circle"></i> <strong>Limited knowledge</strong> of how or where to report leaks</li>
                                    <li><i class="fas fa-phone-slash"></i> Preference for <strong>local community offices</strong> rather than only phone-based support</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Wise Summit Insights</div>
                                <div class="chart-container">
                                    <canvas id="summitChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card insights-card">
                            <div class="card-body">
                                <div class="card-title">Summit Findings - Problems & Solutions</div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Problems Identified</h3>
                                        <ul class="insights-list">
                                            <li><i class="fas fa-trash"></i> Water pollution from waste dumping and litter</li>
                                            <li><i class="fas fa-dumpster"></i> Lack of bins and sanitation infrastructure</li>
                                            <li><i class="fas fa-ban"></i> Blockages due to improper disposal (pads, nappies, plastics)</li>
                                            <li><i class="fas fa-tools"></i> Low technical capacity to address leaks and water quality</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Proposed Solutions</h3>
                                        <ul class="insights-list">
                                            <li><i class="fas fa-graduation-cap"></i> Upskilling locals in plumbing and water treatment</li>
                                            <li><i class="fas fa-users"></i> Creating a "pool of plumbers" for rapid response</li>
                                            <li><i class="fas fa-mobile-alt"></i> Report Leaks App integration</li>
                                            <li><i class="fas fa-chalkboard-teacher"></i> Education workshops for youth and community groups</li>
                                            <li><i class="fas fa-building"></i> Community reporting office for local issue handling</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommendations Tab -->
            <div class="tab-pane fade" id="recommendations" role="tabpanel" aria-labelledby="recommendations-tab">
                <div class="section-header">
                    <h2><i class="fas fa-lightbulb"></i> Recommendations & Next Steps</h2>
                    <p>Evidence-based interventions for sustainable water management</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card solutions-card">
                            <div class="card-body">
                                <div class="card-title">Key Recommendations</div>
                                <ul class="solutions-list">
                                    <li><i class="fas fa-mobile-alt"></i> <strong>Launch the "Report Leaks App"</strong> with GIS tagging for faster response</li>
                                    <li><i class="fas fa-wrench"></i> <strong>Build a Community Plumbing Network</strong> - creating local jobs + faster leak repair</li>
                                    <li><i class="fas fa-chalkboard-teacher"></i> <strong>Design Educational Campaigns</strong> using real survey data insights</li>
                                    <li><i class="fas fa-bullhorn"></i> <strong>Install community noticeboards or SMS alerts</strong> for planned outages</li>
                                    <li><i class="fas fa-expand-arrows-alt"></i> <strong>Expand the Soweto model</strong> to Thembisa and Alexandra</li>
                                    <li><i class="fas fa-chart-line"></i> <strong>Visualize insights in Power BI/Tableau</strong> for dynamic tracking</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Implementation Timeline</div>
                                <div class="chart-container">
                                    <canvas id="implementationChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Community Value Added</div>
                                <div class="quote-text">
                                    This project built both trust and data â€” turning community voices into structured insights that guide water policy and outreach. By leveraging this data-to-action pipeline, Rand Water and Water Wise can make evidence-based interventions that are responsive, localized, and sustainable.
                                </div>
                                <div class="row text-center mt-3 pt-3 border-top">
                                    <div class="col-4">
                                        <div class="stat-value text-primary">Trust</div>
                                        <div class="stat-label">Community Connection</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">Data</div>
                                        <div class="stat-label">Structured Insights</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">Action</div>
                                        <div class="stat-label">Evidence-Based Policy</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Expected Impact Metrics</div>
                                <div class="chart-container">
                                    <canvas id="impactChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="modal fade" id="shareModal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="shareModalLabel"><i class="fas fa-share-alt"></i> Share Report</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">Share this report with your team and stakeholders</p>
                    <div class="d-grid gap-3">
                        <button class="btn btn-outline-primary btn-lg" onclick="shareViaEmail()">
                            <i class="fas fa-envelope"></i> Share via Email
                        </button>
                        <button class="btn btn-outline-success btn-lg" onclick="shareViaWhatsApp()">
                            <i class="fab fa-whatsapp"></i> Share via WhatsApp
                        </button>
                        <button class="btn btn-outline-secondary btn-lg" onclick="copyLink()">
                            <i class="fas fa-link"></i> Copy Link
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: PDF Report Modal -->
    <div class="modal fade" id="pdfModal" tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pdfModalLabel"><i class="fas fa-file-pdf"></i> Full PDF Report</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> View the complete Water Wise Soweto Outreach Final Report in PDF format. You can view it directly in your browser or download it for offline access.
                    </div>
                    
                    <div class="pdf-placeholder">
                        <div class="pdf-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <h3>Water Wise Soweto Outreach - Final Report</h3>
                        <p class="text-muted">Complete PDF Document (24 pages)</p>
                        <p>This comprehensive report includes all data analysis, community feedback, recommendations, and implementation plans from the Soweto Water Wise Outreach initiative.</p>
                        
                        <div class="d-flex justify-content-center gap-3 mt-4 flex-wrap">
                            <button class="btn btn-primary" onclick="viewPDF()">
                                <i class="fas fa-eye"></i> View PDF in Browser
                            </button>
                            <button class="btn btn-success" onclick="downloadPDF()">
                                <i class="fas fa-download"></i> Download PDF
                            </button>
                        </div>
                        
                        <div class="mt-4">
                            <h5>Report Contents:</h5>
                            <ul class="list-group">
                                <li class="list-group-item">Executive Summary</li>
                                <li class="list-group-item">Project Methodology</li>
                                <li class="list-group-item">Quantitative Data Analysis</li>
                                <li class="list-group-item">Qualitative Community Insights</li>
                                <li class="list-group-item">Water Wise Summit Findings</li>
                                <li class="list-group-item">Strategic Recommendations</li>
                                <li class="list-group-item">Implementation Roadmap</li>
                                <li class="list-group-item">Appendices & Raw Data</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- PDF Preview Section (hidden by default) -->
                    <div id="pdfPreview" class="mt-4" style="display: none;">
                        <h5>PDF Preview</h5>
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle"></i> Note: This is a placeholder preview.
                        <div class="text-center p-4 border rounded bg-light">
                            <i class="fas fa-file-pdf fa-5x text-danger mb-3"></i>
                            <h4>Water_Wise_Soweto_Outreach_Final_Report.pdf</h4>
                            <p class="text-muted">File size: 4.2 MB | Last updated: November 08, 2025</p>
                            <div class="mt-3">
                                <a href="#" class="pdf-download-link" onclick="downloadPDF()">
                                    <i class="fas fa-download"></i> Download Full PDF
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="downloadPDF()">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Color scheme
        const colors = {
            primary: ['#0066cc', '#0099ff', '#00cccc', '#004d99', '#008fb3', '#00b3b3'],
            gradient1: ['rgba(0, 102, 204, 0.8)', 'rgba(0, 153, 255, 0.8)'],
            gradient2: ['rgba(0, 204, 204, 0.8)', 'rgba(0, 179, 179, 0.8)']
        };

        // Store chart instances
        const chartInstances = {};

        // Create water droplets
        function createWaterDrops() {
            const container = document.getElementById('waterDrops');
            for (let i = 0; i < 15; i++) {
                const drop = document.createElement('div');
                drop.className = 'water-drop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = (Math.random() * 3 + 2) + 's';
                drop.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(drop);
            }
        }

        // Animated counter
        function animateCounter(element) {
            const target = parseInt(element.getAttribute('data-target'));
            const duration = 2000;
            const step = target / (duration / 16);
            let current = 0;

            const timer = setInterval(() => {
                current += step;
                if (current >= target) {
                    element.textContent = target + (element.textContent.includes('%') ? '%' : '');
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current) + (element.textContent.includes('%') ? '%' : '');
                }
            }, 16);
        }

        // Toast notification
        function showToast(message, type = 'success') {
            const toastHTML = `
                <div class="toast toast-${type} show" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} me-2"></i>
                        <strong class="me-auto">Notification</strong>
                        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">${message}</div>
                </div>
            `;
            
            const container = document.getElementById('toastContainer');
            container.insertAdjacentHTML('beforeend', toastHTML);
            
            setTimeout(() => {
                const toasts = container.querySelectorAll('.toast');
                if (toasts.length > 0) {
                    toasts[0].remove();
                }
            }, 3000);
        }

        // Share functions
        function shareViaEmail() {
            const subject = encodeURIComponent('Water Wise Soweto Outreach - Final Report');
            const body = encodeURIComponent('Check out the Water Wise Soweto Outreach Final Report: ' + window.location.href);
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
            showToast('Opening email client...');
        }

        function shareViaWhatsApp() {
            const text = encodeURIComponent('Check out the Water Wise Soweto Outreach Final Report: ' + window.location.href);
            window.open(`https://wa.me/?text=${text}`, '_blank');
            showToast('Opening WhatsApp...');
        }

        function copyLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                showToast('Link copied to clipboard!');
            }).catch(() => {
                showToast('Failed to copy link', 'error');
            });
        }

        // NEW: PDF Functions
        function viewPDF() {
            // In a real implementation, this would open the actual PDF
            document.getElementById('pdfPreview').style.display = 'block';
            showToast('Opening PDF preview...');
            
            // Scroll to the preview section
            document.getElementById('pdfPreview').scrollIntoView({ behavior: 'smooth' });
        }

         function downloadPDF() {
            const link = document.createElement('a');
            link.href = '/assets/SowetoFullReportOutreach-Rand Water x Water Wise.pdf';
            link.download = 'Soweto-Water-Wise-Outreach-Report.pdf';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function openPDF() {
            window.open('/assets/SowetoFullReportOutreach-Rand Water x Water Wise.pdf', '_blank');
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.altKey && e.key === 'p') {
                e.preventDefault();
                window.print();
            }
            if (e.altKey && e.key === 'd') {
                e.preventDefault();
                downloadExcel();
            }
            if (e.altKey && e.key === 'f') {
                e.preventDefault();
                // Open PDF modal with keyboard shortcut
                const pdfModal = new bootstrap.Modal(document.getElementById('pdfModal'));
                pdfModal.show();
            }
        });

        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function(tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });

            // Create water drops
            createWaterDrops();

            // Animate counters
            document.querySelectorAll('.stat-value[data-target]').forEach(animateCounter);

            // Initialize charts
            initializeOverviewCharts();

            // Tab change handlers
            const tabButtons = document.querySelectorAll('button[data-bs-toggle="pill"]');
            tabButtons.forEach(button => {
                button.addEventListener('shown.bs.tab', function(e) {
                    const targetId = e.target.getAttribute('data-bs-target').substring(1);
                    
                    if (targetId === 'quantitative' && !chartInstances.quantitativeInitialized) {
                        setTimeout(() => {
                            initializeQuantitativeCharts();
                            chartInstances.quantitativeInitialized = true;
                        }, 100);
                    } else if (targetId === 'qualitative' && !chartInstances.qualitativeInitialized) {
                        setTimeout(() => {
                            initializeQualitativeCharts();
                            chartInstances.qualitativeInitialized = true;
                        }, 100);
                    } else if (targetId === 'recommendations' && !chartInstances.recommendationsInitialized) {
                        setTimeout(() => {
                            initializeRecommendationsCharts();
                            chartInstances.recommendationsInitialized = true;
                        }, 100);
                    }
                });
            });

            // Button event listeners
            document.getElementById('printBtn').addEventListener('click', function() {
                window.print();
                showToast('Preparing print view...');
            });

            document.getElementById('downloadBtn').addEventListener('click', function() {
                downloadExcel();
                showToast('Downloading Excel file...');
            });
        });

        // Initialize Overview Charts
        function initializeOverviewCharts() {
            createTimelineChart('timelineChart');
            createDataCollectionChart('dataCollectionChart');
            createEngagementChart('engagementChart');
        }

        // Initialize Quantitative Charts
        function initializeQuantitativeCharts() {
            createHouseholdChart('householdChart', [33.5, 25, 25, 16.5]);
            createDwellingChart('dwellingChart', [64.3, 19, 4.8, 11.9]);
            createOwnershipChart('ownershipChart', [50, 35.7, 14.3]);
            createMeterChart('meterChart', [59.5, 26.2, 14.3]);
            createShortageChart('shortageChart', [66.7, 19, 2.4, 11.9]);
            createInfrastructureChart('infrastructureChart', [21.4, 9.5, 21.4, 21.4, 7.1, 19]);
            createDevicesChart('devicesChart', [57.1, 11.9, 9.5, 7.1, 2.4, 11.9]);
            createGardenChart('gardenChart', [38.1, 26.2, 9.5, 7.1, 7.1, 11.9]);
            createEducationChart('educationChart', [38.1, 45.2, 4.8, 11.9]);
            createWillingnessChart('willingnessChart', [73.8, 7.1, 19]);
        }

        // Initialize Qualitative Charts
        function initializeQualitativeCharts() {
            createCommunicationChart('communicationChart');
            createSummitChart('summitChart');
        }

        // Initialize Recommendations Charts
        function initializeRecommendationsCharts() {
            createImplementationChart('implementationChart');
            createImpactChart('impactChart');
        }

        // Chart creation functions
        function createTimelineChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Summit'],
                    datasets: [{
                        label: 'Surveys Completed',
                        data: [12, 30, 25, 150],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }, {
                        label: 'Community Engagement',
                        data: [45, 75, 80, 200],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Participants'
                            }
                        }
                    }
                }
            });
        }

        function createDataCollectionChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Household Surveys', 'Summit Feedback', 'Focus Groups', 'Observational Data'],
                    datasets: [{
                        data: [67, 150, 45, 30],
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEngagementChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Workshop Interest', 'Water Concern', 'Community Role Belief', 'Willingness to Adopt'],
                    datasets: [{
                        data: [78, 80, 90, 75],
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createHouseholdChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['6 or more', '1 person', '4-5 people', '2-3 people'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createDwellingChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Brick house', 'Informal settlement', 'RDP house', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createOwnershipChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Own', 'Rent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createMeterChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createShortageChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Occasionally', 'Frequently', 'Rarely', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createInfrastructureChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: ['Poor', 'Very poor', 'Fair', 'Good', 'Excellent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary.map(c => c + 'CC')
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createDevicesChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Dual-flush toilet', 'Dual-flush + Low-flow', 'Low-flow showerhead', 'Dual-flush + Greywater', 'Greywater system', 'None/Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createGardenChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ["Don't water garden", 'Hosepipe', 'Not applicable', 'Bucket', 'Sprinkler', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEducationChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Not sure', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createWillingnessChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Yes', 'Maybe', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createCommunicationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Lack of outage info', 'Meter issues', 'Greywater reliance', 'Reporting knowledge gap', 'Prefer local offices'],
                    datasets: [{
                        label: 'Residents Reporting Issue',
                        data: [85, 70, 65, 60, 75],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createSummitChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Water pollution', 'Lack of bins', 'Blockages', 'Technical capacity'],
                    datasets: [{
                        label: 'Problems Identified',
                        data: [80, 75, 70, 65],
                        backgroundColor: colors.primary[1],
                        borderRadius: 10
                    }, {
                        label: 'Solutions Proposed',
                        data: [85, 80, 75, 90],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImplementationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025'],
                    datasets: [{
                        label: 'Report Leaks App',
                        data: [10, 40, 70, 90, 100],
                        borderColor: colors.primary[0],
                        backgroundColor: colors.primary[0] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Community Plumbing Network',
                        data: [5, 25, 60, 85, 95],
                        borderColor: colors.primary[1],
                        backgroundColor: colors.primary[1] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Education Campaigns',
                        data: [15, 45, 75, 90, 100],
                        borderColor: colors.primary[2],
                        backgroundColor: colors.primary[2] + '20',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImpactChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Leak Reporting', 'Response Time', 'Water Conservation', 'Community Engagement', 'Infrastructure Rating'],
                    datasets: [{
                        label: 'Current',
                        data: [30, 40, 45, 65, 50],
                        backgroundColor: colors.primary[0],
                        borderRadius: 5
                    }, {
                        label: 'Target (12 months)',
                        data: [80, 75, 70, 85, 75],
                        backgroundColor: colors.primary[2],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        // Download Excel functionality
        function downloadExcel() {
            const data = [
                ['Water Wise Soweto Outreach - Final Report Data', '', '', ''],
                ['', '', '', ''],
                ['Quantitative Analysis Summary', '', '', ''],
                ['Metric', 'Value', 'Insight', ''],
                ['Household Size (4-5 people)', '25%', 'Average household size', ''],
                ['Brick House Dwellings', '64.3%', 'Majority housing type', ''],
                ['Property Ownership', '50%', 'Half of residents own their property', ''],
                ['Water Meter Access', '59.5%', 'Significant portion lack functional meters', ''],
                ['Water Shortages (Occasionally)', '66.7%', 'Most experience regular shortages', ''],
                ['Infrastructure Rating (Fair)', '21.4%', 'Infrastructure generally rated as fair', ''],
                ['Water-Saving Devices', '15-20%', 'Low adoption of water-saving technology', ''],
                ['Water Conservation Education', '45%', 'Less than half received education', ''],
                ['Workshop Interest', '78%', 'Strong community interest in workshops', ''],
                ['Willingness to Adopt', '75%', 'High willingness to adopt water-saving practices', ''],
                ['', '', '', ''],
                ['Qualitative Insights Summary', '', '', ''],
                ['Challenge', 'Impact', 'Resident Quote', ''],
                ['Lack of Communication', 'High', '"We don\'t know when water will go. No one tells us."', ''],
                ['Non-functional Meters', 'Medium-High', '"Our meter doesn\'t work, and no one comes to fix it."', ''],
                ['Greywater Reliance', 'Medium', '"We wash food with grey water when there\'s no water."', ''],
                ['Reporting Knowledge Gap', 'High', 'Over 60% didn\'t know how to report leaks', ''],
                ['Preference for Local Support', 'Medium', 'Residents prefer local offices over phone support', ''],
                ['', '', '', ''],
                ['Key Recommendations', '', '', ''],
                ['Recommendation', 'Priority', 'Expected Impact', ''],
                ['Launch "Report Leaks App"', 'High', 'Faster response to water issues', ''],
                ['Build Community Plumbing Network', 'High', 'Local jobs + faster repairs', ''],
                ['Design Educational Campaigns', 'Medium', 'Increased water conservation awareness', ''],
                ['Install community noticeboards/SMS alerts', 'High', 'Better communication on outages', ''],
                ['Expand Soweto model to other areas', 'Medium', 'Broader community impact', ''],
                ['Visualize insights in Power BI/Tableau', 'Low', 'Dynamic tracking and reporting', '']
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Soweto Final Report");
            XLSX.writeFile(wb, "Water_Wise_Soweto_Final_Report.xlsx");
        }
    </script>
</body>
</html>